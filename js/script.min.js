const openPopup = document.querySelector(".popup-link"), popup = document.querySelector(".popup"), closePopup = document.querySelector(".close-popup"), modal = document.querySelector(".popup__body"), popupForm = popup.querySelector(".modal-form"), loginName = popup.querySelector(".user-name"), loginEmail = popup.querySelector(".user-email"); let isStorageSupport = !0, storage = ""; try { storage = localStorage.getItem("name") } catch (p) { isStorageSupport = !1 } openPopup.addEventListener("click", function (p) { p.preventDefault(), popup.classList.add("popup-show"), storage ? (loginName.value = storage, loginEmail.focus()) : loginName.focus() }), closePopup.addEventListener("click", function (p) { p.preventDefault(), popup.classList.remove("popup-show"), popup.classList.remove("popup-error") }), popupForm.addEventListener("submit", function (p) { loginName.value && loginEmail.value ? isStorageSupport && localStorage.setItem("name", loginName.value) : (p.preventDefault(), popup.classList.remove("popup-error"), popup.offsetWidth = popup.offsetWidth, popup.classList.add("popup-error")) }), window.onclick = function (p) { p.target == modal && popup.classList.remove("popup-show") }, window.addEventListener("keydown", function (p) { "Esc" !== p.key && "Escape" !== p.key || popup.classList.contains("popup-show") && (p.preventDefault(), popup.classList.remove("popup-show"), popup.classList.remove("popup-error")) });
